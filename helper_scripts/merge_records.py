import glob

import pandas as pd


def get_samples_df_from_files(file_list):
    samples = []
    for file in file_list:
        df = pd.read_csv(file, index_col=None, header=0, low_memory=False)
        samples.append(df)
    df_out = pd.concat(samples, ignore_index=True)
    return df_out


sample_dir = "../data/*/*/*ISCX.csv"
sample_files_list = glob.glob(sample_dir)
df = get_samples_df_from_files(sample_files_list)
df.columns = [col.lstrip() for col in df.columns.values]
benign = df[df['Label'] == 'BENIGN'].sample(frac=0.3, random_state=111)
df = df[df['Label'] != 'BENIGN']
df = df.append(benign)
df = df.sample(frac=0.2, random_state=111)
df.to_csv("../data/balanced_dataset.csv")
